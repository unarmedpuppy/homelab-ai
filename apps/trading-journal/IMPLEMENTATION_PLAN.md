# Trading Journal Application - Implementation Plan

## Overview

A self-hosted trading journal application inspired by Tradezella, designed for personal use. The application will track trades, visualize performance, and provide comprehensive analytics through a responsive web interface.

## Core Features (MVP)

### 1. Trade Entry & Management
- **Create Trade Entry**: Form-based entry with date picker (defaults to today)
- **Trade Details**:
  - Ticker symbol
  - Trade type: STOCK, OPTION, CRYPTO_SPOT, CRYPTO_PERP, PREDICTION_MARKET
  - Options chain information (if applicable):
    - Strike price, expiration date, call/put
    - **All Greeks**: Delta, Gamma, Theta, Vega, Rho
    - Implied Volatility (IV)
    - Volume and Open Interest
    - Bid/Ask spreads
  - Entry price, quantity, time
  - Exit price, quantity, time
  - Commissions/fees
  - Notes/strategy tags/playbook
- **Manual Input**: All trades entered manually (no broker integration in MVP)
- **Single-leg Only**: MVP supports only single-leg trades (no spreads, iron condors, etc.)

### 2. Dashboard View
- **Key Performance Indicators (KPIs)**:
  - Net P&L (total and period-based)
  - Trade win percentage
  - Profit factor
  - Day win percentage
  - Average win/loss trade
  - Max drawdown
  - Zella score (composite metric)
- **Charts**:
  - Daily net cumulative P&L line chart
  - Net daily P&L bar chart
  - Win/loss distribution charts
  - Profit factor visualization
  - Drawdown chart
- **Recent Trades Table**: Quick view of latest closed trades
- **Account Balance**: Placeholder for future integration

### 3. Calendar View (Critical Feature)
- **Monthly Calendar**: Navigate between months
- **Daily Summary**: Each day shows:
  - Net P&L for the day
  - Number of trades executed
  - Color coding:
    - Green: Profitable day
    - Red: Losing day
    - Gray: No trades or break-even
- **Date Selection**: Click date to view daily journal
- **Visual Indicators**: Clear visual representation of trading activity

### 4. Daily Journal View
- **Selected Date Header**: Date, net P&L, trade count
- **Trade List Table**: All trades for selected day
  - Columns: Open time, Ticker, Side (CALL/PUT/LONG/SHORT), Net P&L, Net ROI, Realized R-Multiple, Playbook
  - Sortable and filterable
- **Daily Performance Summary**:
  - Total trades, winners, losers
  - Winrate percentage
  - Gross P&L, commissions, volume
  - Profit factor
- **P&L Progression Chart**: Line chart showing P&L throughout the day
- **Notes**: Add daily notes/observations

### 5. Trade Visualization (Chart View)
- **Historical Price Chart**: 
  - Display ticker price data for trade timeframe
  - Show entry/exit points visually
  - Support all timeframes: 1m, 5m, 15m, 1h, 1d (1h is primary/default)
  - Candlestick/line chart options
  - Configurable date range (default: 1 year, configurable)
- **Options Chain Visualization**: Display relevant options data if applicable
- **Trade Overlay**: Mark entry/exit points on chart

### 6. Backend API (AI Agent Compatible)
- **RESTful API**: All data access through API (no direct DB queries from frontend)
- **Comprehensive Endpoints**: Every UI action has a corresponding API endpoint for AI agent interaction
- **Authentication**: Simple API key authentication (single user for MVP)
- **OpenAPI Documentation**: Auto-generated Swagger/OpenAPI docs for easy AI agent integration
- **All Endpoints** (see detailed API specification below):
  - Complete CRUD operations for trades
  - Dashboard statistics and metrics
  - Calendar data and navigation
  - Daily journal operations
  - Chart data and price history
  - Options chain data
  - Daily notes management
  - Bulk operations

## Technology Stack

### Frontend
- **Framework**: React 18+ with TypeScript
- **UI Library**: 
  - Material-UI (MUI) v5 or Tailwind CSS + Headless UI
  - TradingView Lightweight Charts for price charts
  - Recharts or Chart.js for dashboard charts
- **State Management**: React Query (TanStack Query) for server state, Zustand for client state
- **Date Handling**: date-fns or dayjs
- **HTTP Client**: Axios or fetch API
- **Build Tool**: Vite

### Backend
- **Framework**: FastAPI (Python) - consistent with trading-bot
- **Database**: PostgreSQL 15+
- **ORM**: SQLAlchemy 2.0 with async support
- **API Documentation**: OpenAPI/Swagger (auto-generated by FastAPI)
- **Data Validation**: Pydantic models
- **Historical Data**: 
  - Primary: Alpha Vantage API (free tier available)
  - Fallback: yfinance (Python library) - supports stocks, crypto
  - Crypto: CoinGecko API (free tier) for crypto spot/perps
  - Future: Polygon.io (paid, more reliable for options)
- **Price Data Caching**: Cache all fetched price data to reduce API calls
- **Configurable Range**: Default 1 year, configurable up to available data

### Infrastructure
- **Containerization**: Docker Compose
- **Database**: PostgreSQL container
- **Reverse Proxy**: Traefik (existing)
- **Network**: `my-network` (external network)

## Database Schema

### Tables

#### `trades`
```sql
CREATE TABLE trades (
    id SERIAL PRIMARY KEY,
    user_id INTEGER DEFAULT 1,  -- Single user for MVP
    ticker VARCHAR(20) NOT NULL,  -- Increased for crypto symbols
    trade_type VARCHAR(20) NOT NULL,  -- 'STOCK', 'OPTION', 'CRYPTO_SPOT', 'CRYPTO_PERP', 'PREDICTION_MARKET'
    
    -- Entry details
    entry_price DECIMAL(12, 4) NOT NULL,
    entry_quantity DECIMAL(12, 4) NOT NULL,  -- Decimal for crypto
    entry_time TIMESTAMP NOT NULL,
    entry_commission DECIMAL(10, 2) DEFAULT 0,
    
    -- Exit details
    exit_price DECIMAL(12, 4),
    exit_quantity DECIMAL(12, 4),
    exit_time TIMESTAMP,
    exit_commission DECIMAL(10, 2) DEFAULT 0,
    
    -- Options specific (all fields)
    strike_price DECIMAL(12, 4),
    expiration_date DATE,
    option_type VARCHAR(4),  -- 'CALL' or 'PUT'
    -- Greeks
    delta DECIMAL(8, 4),
    gamma DECIMAL(8, 6),
    theta DECIMAL(8, 4),
    vega DECIMAL(8, 4),
    rho DECIMAL(8, 4),
    -- Options market data
    implied_volatility DECIMAL(6, 4),  -- IV as percentage
    volume BIGINT,
    open_interest BIGINT,
    bid_price DECIMAL(12, 4),
    ask_price DECIMAL(12, 4),
    bid_ask_spread DECIMAL(12, 4),
    
    -- Crypto specific
    crypto_exchange VARCHAR(50),  -- e.g., 'BINANCE', 'COINBASE'
    crypto_pair VARCHAR(20),  -- e.g., 'BTC/USD', 'ETH/USDT'
    
    -- Prediction market specific
    prediction_market_platform VARCHAR(50),
    prediction_outcome VARCHAR(200),
    
    -- Calculated fields
    net_pnl DECIMAL(12, 2),
    net_roi DECIMAL(8, 4),  -- Percentage
    realized_r_multiple DECIMAL(8, 4),
    
    -- Metadata
    status VARCHAR(20) DEFAULT 'open',  -- 'open', 'closed', 'partial'
    side VARCHAR(10) NOT NULL,  -- 'LONG', 'SHORT'
    playbook VARCHAR(100),
    notes TEXT,
    tags TEXT[],  -- Array of tags for categorization
    
    -- Timestamps
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_trades_entry_time ON trades(entry_time);
CREATE INDEX idx_trades_ticker ON trades(ticker);
CREATE INDEX idx_trades_status ON trades(status);
CREATE INDEX idx_trades_trade_type ON trades(trade_type);
CREATE INDEX idx_trades_expiration_date ON trades(expiration_date);
```

#### `daily_summaries` (materialized view or table)
```sql
CREATE TABLE daily_summaries (
    date DATE PRIMARY KEY,
    total_trades INTEGER DEFAULT 0,
    winners INTEGER DEFAULT 0,
    losers INTEGER DEFAULT 0,
    gross_pnl DECIMAL(12, 2) DEFAULT 0,
    commissions DECIMAL(10, 2) DEFAULT 0,
    volume INTEGER DEFAULT 0,
    profit_factor DECIMAL(8, 4),
    winrate DECIMAL(5, 2),
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_daily_summaries_date ON daily_summaries(date);
```

#### `price_cache` (for historical data caching)
```sql
CREATE TABLE price_cache (
    id SERIAL PRIMARY KEY,
    ticker VARCHAR(20) NOT NULL,  -- Increased for crypto symbols
    timestamp TIMESTAMP NOT NULL,  -- Changed from date to timestamp for intraday data
    timeframe VARCHAR(10) NOT NULL,  -- '1m', '5m', '15m', '1h', '1d'
    open_price DECIMAL(12, 4),
    high_price DECIMAL(12, 4),
    low_price DECIMAL(12, 4),
    close_price DECIMAL(12, 4),
    volume BIGINT,
    cached_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE(ticker, timestamp, timeframe)
);

CREATE INDEX idx_price_cache_ticker_timestamp ON price_cache(ticker, timestamp);
CREATE INDEX idx_price_cache_timeframe ON price_cache(timeframe);
```

#### `daily_notes` (for daily journal notes)
```sql
CREATE TABLE daily_notes (
    id SERIAL PRIMARY KEY,
    date DATE NOT NULL UNIQUE,
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_daily_notes_date ON daily_notes(date);
```

## Project Structure

```
apps/trading-journal/
├── docker-compose.yml          # Main compose file
├── env.template                # Environment variables template
├── README.md                   # Setup and usage instructions
├── .gitignore                  # Git ignore rules
│
├── backend/                    # FastAPI backend
│   ├── Dockerfile
│   ├── requirements.txt
│   ├── .env.example
│   ├── app/
│   │   ├── __init__.py
│   │   ├── main.py             # FastAPI app entry point
│   │   ├── config.py           # Configuration management
│   │   ├── database.py         # Database connection
│   │   │
│   │   ├── models/             # SQLAlchemy models
│   │   │   ├── __init__.py
│   │   │   ├── trade.py
│   │   │   ├── daily_summary.py
│   │   │   └── price_cache.py
│   │   │
│   │   ├── schemas/            # Pydantic schemas
│   │   │   ├── __init__.py
│   │   │   ├── trade.py
│   │   │   ├── dashboard.py
│   │   │   └── calendar.py
│   │   │
│   │   ├── api/                # API routes
│   │   │   ├── __init__.py
│   │   │   ├── routes/
│   │   │   │   ├── __init__.py
│   │   │   │   ├── trades.py
│   │   │   │   ├── dashboard.py
│   │   │   │   ├── calendar.py
│   │   │   │   └── charts.py
│   │   │   │
│   │   │   └── dependencies.py # Auth, DB session, etc.
│   │   │
│   │   ├── services/           # Business logic
│   │   │   ├── __init__.py
│   │   │   ├── trade_service.py
│   │   │   ├── dashboard_service.py
│   │   │   ├── calendar_service.py
│   │   │   └── price_service.py
│   │   │
│   │   └── utils/              # Utilities
│   │       ├── __init__.py
│   │       ├── calculations.py  # P&L, ROI, R-multiple calculations
│   │       └── validators.py
│   │
│   └── alembic/                # Database migrations
│       ├── versions/
│       └── alembic.ini
│
├── frontend/                    # React frontend
│   ├── Dockerfile
│   ├── package.json
│   ├── vite.config.ts
│   ├── tsconfig.json
│   ├── .env.example
│   │
│   ├── public/
│   │   └── index.html
│   │
│   └── src/
│       ├── main.tsx
│       ├── App.tsx
│       ├── vite-env.d.ts
│       │
│       ├── api/                 # API client
│       │   ├── client.ts
│       │   ├── trades.ts
│       │   ├── dashboard.ts
│       │   └── charts.ts
│       │
│       ├── components/          # React components
│       │   ├── layout/
│       │   │   ├── Sidebar.tsx
│       │   │   ├── Header.tsx
│       │   │   └── Layout.tsx
│       │   │
│       │   ├── dashboard/
│       │   │   ├── Dashboard.tsx
│       │   │   ├── KPICard.tsx
│       │   │   ├── PnLChart.tsx
│       │   │   └── RecentTrades.tsx
│       │   │
│       │   ├── calendar/
│       │   │   ├── CalendarView.tsx
│       │   │   ├── CalendarGrid.tsx
│       │   │   └── DayCell.tsx
│       │   │
│       │   ├── daily-journal/
│       │   │   ├── DailyJournal.tsx
│       │   │   ├── TradeTable.tsx
│       │   │   ├── DailySummary.tsx
│       │   │   └── PnLProgression.tsx
│       │   │
│       │   ├── trade-entry/
│       │   │   ├── TradeEntryForm.tsx
│       │   │   ├── OptionsChainInput.tsx
│       │   │   └── PriceInput.tsx
│       │   │
│       │   ├── charts/
│       │   │   ├── PriceChart.tsx
│       │   │   ├── TradeOverlay.tsx
│       │   │   └── ChartControls.tsx
│       │   │
│       │   └── common/
│       │       ├── DatePicker.tsx
│       │       ├── LoadingSpinner.tsx
│       │       └── ErrorBoundary.tsx
│       │
│       ├── hooks/               # Custom React hooks
│       │   ├── useTrades.ts
│       │   ├── useDashboard.ts
│       │   └── usePriceData.ts
│       │
│       ├── store/               # State management
│       │   ├── tradeStore.ts
│       │   └── uiStore.ts
│       │
│       ├── types/               # TypeScript types
│       │   ├── trade.ts
│       │   ├── dashboard.ts
│       │   └── api.ts
│       │
│       ├── utils/                # Utilities
│       │   ├── formatters.ts
│       │   ├── calculations.ts
│       │   └── validators.ts
│       │
│       └── styles/              # Global styles
│           ├── index.css
│           └── theme.ts
│
└── data/                        # Persistent data (gitignored)
    ├── postgres/                # PostgreSQL data
    └── cache/                   # Price data cache
```

## Docker Compose Configuration

### Services
1. **PostgreSQL**: Database
2. **Backend**: FastAPI application
3. **Frontend**: React application (served via Nginx in production)

### Port Assignment
- **Backend API**: `8100` (available, not in use)
- **Frontend**: `8101` (available, not in use)
- **PostgreSQL**: Internal only (no exposed port)

### Network
- All services on `my-network` (external)

## Implementation Phases

### Phase 1: Foundation (Week 1)
- [ ] Set up project structure
- [ ] Configure Docker Compose with PostgreSQL
- [ ] Create database schema and migrations
- [ ] Set up FastAPI backend with basic structure
- [ ] Set up React frontend with Vite
- [ ] Implement basic API endpoints (CRUD for trades)
- [ ] Create basic trade entry form

### Phase 2: Core Features (Week 2)
- [ ] Implement dashboard view with KPIs
- [ ] Create calendar view with daily summaries
- [ ] Build daily journal view
- [ ] Add P&L calculations (net P&L, ROI, R-multiple)
- [ ] Implement trade list/table components
- [ ] Add date filtering and navigation

### Phase 3: Charts & Visualization (Week 3)
- [ ] Integrate TradingView Lightweight Charts
- [ ] Implement historical price data fetching
- [ ] Create price chart component with trade overlays
- [ ] Add P&L progression charts
- [ ] Implement dashboard charts (cumulative P&L, daily P&L)

### Phase 4: Polish & Optimization (Week 4)
- [ ] Add responsive design for mobile
- [ ] Implement price data caching
- [ ] Add error handling and loading states
- [ ] Optimize API queries and add pagination
- [ ] Add data validation and error messages
- [ ] Create README and documentation

### Phase 5: Advanced Features (Future)
- [ ] Robinhood integration (bonus feature)
- [ ] Trade import/export (CSV)
- [ ] Advanced analytics and reports (Sharpe ratio, Sortino ratio, etc.)
- [ ] Trade tagging and categorization (already in schema)
- [ ] Multi-leg strategies (spreads, iron condors, etc.)
- [ ] Multi-account support
- [ ] Real-time price updates via WebSocket
- [ ] Trade alerts and notifications

## API Endpoints Specification

**All endpoints require API key authentication via header: `X-API-Key: <your-api-key>`**

### Trades (Complete CRUD + Search)
```
GET    /api/trades
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
         - ticker: string (optional)
         - trade_type: STOCK|OPTION|CRYPTO_SPOT|CRYPTO_PERP|PREDICTION_MARKET (optional)
         - status: open|closed|partial (optional)
         - side: LONG|SHORT (optional)
         - limit: integer (default: 100, max: 1000)
         - offset: integer (default: 0)
       Returns: List of trades with pagination metadata

GET    /api/trades/:id
       Returns: Single trade with all details

POST   /api/trades
       Body: TradeCreate schema (all fields)
       Returns: Created trade

PUT    /api/trades/:id
       Body: TradeUpdate schema (partial update supported)
       Returns: Updated trade

PATCH  /api/trades/:id
       Body: Partial trade update
       Returns: Updated trade

DELETE /api/trades/:id
       Returns: Success confirmation

POST   /api/trades/bulk
       Body: Array of TradeCreate schemas
       Returns: Array of created trades

GET    /api/trades/search
       Query params:
         - q: search query (searches ticker, notes, playbook)
         - tags: comma-separated tags
       Returns: Matching trades
```

### Dashboard (Statistics & Metrics)
```
GET    /api/dashboard/stats
       Query params:
         - date_from: ISO date (optional, default: all time)
         - date_to: ISO date (optional, default: today)
       Returns: Complete dashboard statistics:
         - net_pnl, gross_pnl
         - total_trades, winners, losers
         - win_rate, day_win_rate
         - profit_factor
         - avg_win, avg_loss
         - max_drawdown
         - zella_score

GET    /api/dashboard/cumulative-pnl
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
         - group_by: day|week|month (default: day)
       Returns: Array of {date, cumulative_pnl} points

GET    /api/dashboard/daily-pnl
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Array of {date, pnl, trade_count} points

GET    /api/dashboard/drawdown
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Drawdown data with peak, trough, recovery points

GET    /api/dashboard/recent-trades
       Query params:
         - limit: integer (default: 10, max: 100)
       Returns: Most recent closed trades
```

### Calendar (Monthly View & Navigation)
```
GET    /api/calendar/:year/:month
       Path params:
         - year: integer (YYYY)
         - month: integer (1-12)
       Returns: Calendar data for month:
         - days: Array of {date, pnl, trade_count, is_profitable}
         - month_summary: {total_pnl, total_trades, profitable_days, losing_days}

GET    /api/calendar/summary
       Query params:
         - date_from: ISO date
         - date_to: ISO date
       Returns: Summary for date range

GET    /api/calendar/date/:date
       Path params:
         - date: ISO date (YYYY-MM-DD)
       Returns: Single day summary
```

### Daily Journal (Daily View & Notes)
```
GET    /api/daily/:date
       Path params:
         - date: ISO date (YYYY-MM-DD)
       Returns: Complete daily journal data:
         - date, net_pnl
         - trades: Array of trades for the day
         - summary: {total_trades, winners, losers, winrate, gross_pnl, commissions, volume, profit_factor}
         - notes: Daily notes if any
         - pnl_progression: Array of {time, cumulative_pnl} points

GET    /api/daily/:date/trades
       Returns: Just the trades for the day

GET    /api/daily/:date/summary
       Returns: Just the summary for the day

GET    /api/daily/:date/pnl-progression
       Returns: P&L progression throughout the day

GET    /api/daily/:date/notes
       Returns: Daily notes

POST   /api/daily/:date/notes
       Body: {notes: string}
       Returns: Updated notes

PUT    /api/daily/:date/notes
       Body: {notes: string}
       Returns: Updated notes

DELETE /api/daily/:date/notes
       Returns: Success confirmation
```

### Charts (Price Data & Visualization)
```
GET    /api/charts/prices/:ticker
       Path params:
         - ticker: string
       Query params:
         - start_date: ISO datetime (optional, default: 1 year ago)
         - end_date: ISO datetime (optional, default: now)
         - timeframe: 1m|5m|15m|1h|1d (default: 1h)
       Returns: Array of OHLCV data points:
         {timestamp, open, high, low, close, volume}

GET    /api/charts/prices/:ticker/range
       Query params:
         - days: integer (default: 365, max: 365)
         - timeframe: 1m|5m|15m|1h|1d (default: 1h)
       Returns: Price data for specified range

GET    /api/charts/trade/:trade_id
       Returns: Price data for trade timeframe with entry/exit markers

GET    /api/charts/cumulative-pnl
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
         - group_by: day|week|month (default: day)
       Returns: Cumulative P&L chart data

GET    /api/charts/daily-pnl
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Daily P&L bar chart data
```

### Options Chain (Options Data)
```
GET    /api/options/chain/:ticker
       Path params:
         - ticker: string
       Query params:
         - expiration_date: ISO date (optional, default: all)
         - option_type: CALL|PUT (optional)
       Returns: Options chain data with all Greeks and market data

GET    /api/options/chain/:ticker/:expiration
       Returns: Options chain for specific expiration

GET    /api/options/greeks/:ticker
       Query params:
         - strike: decimal (optional)
         - expiration: ISO date (optional)
       Returns: Greeks data for ticker
```

### Analytics & Reports
```
GET    /api/analytics/performance
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Performance metrics:
         - sharpe_ratio, sortino_ratio
         - max_drawdown, avg_drawdown
         - win_rate, profit_factor
         - avg_win, avg_loss
         - best_trade, worst_trade

GET    /api/analytics/by-ticker
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Performance breakdown by ticker

GET    /api/analytics/by-type
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Performance breakdown by trade type

GET    /api/analytics/by-playbook
       Query params:
         - date_from: ISO date (optional)
         - date_to: ISO date (optional)
       Returns: Performance breakdown by playbook/strategy
```

### Health & System
```
GET    /api/health
       Returns: API health status

GET    /api/version
       Returns: API version information

GET    /api/docs
       Returns: OpenAPI/Swagger documentation (HTML)

GET    /api/openapi.json
       Returns: OpenAPI specification (JSON)
```

### AI Agent Helper Endpoints
```
POST   /api/ai/parse-trade
       Body: {description: string, raw_data: object}
       Returns: Parsed trade data ready for creation
       Description: Helper endpoint for AI agents to parse natural language trade descriptions

POST   /api/ai/batch-create
       Body: Array of trade descriptions or raw data
       Returns: Array of created trades
       Description: Bulk trade creation from AI agent input

GET    /api/ai/suggestions/:ticker
       Returns: Suggested trade details based on ticker history
       Description: AI helper for suggesting trade parameters
```

## Environment Variables

### Backend
```env
# Database
DATABASE_URL=postgresql://trading_journal:password@postgres:5432/trading_journal

# API
API_KEY=your-secret-api-key
API_HOST=0.0.0.0
API_PORT=8000

# External APIs
ALPHA_VANTAGE_API_KEY=your-alpha-vantage-key
POLYGON_API_KEY=your-polygon-key  # Optional

# CORS
CORS_ORIGINS=http://localhost:8101,http://192.168.86.47:8101

# Environment
ENVIRONMENT=production
DEBUG=false
```

### Frontend
```env
VITE_API_URL=http://localhost:8100/api
VITE_APP_NAME=Trading Journal
```

## Security Considerations

1. **API Authentication**: Simple API key for MVP (single user)
2. **Input Validation**: Validate all inputs on backend
3. **SQL Injection**: Use ORM (SQLAlchemy) - no raw SQL
4. **CORS**: Configure CORS properly for frontend
5. **Rate Limiting**: Add rate limiting for external API calls
6. **Data Privacy**: All data stored locally on server

## Performance Optimizations

1. **Price Data Caching**: Cache historical price data to reduce API calls
2. **Database Indexing**: Proper indexes on frequently queried columns
3. **Materialized Views**: Use materialized views for daily summaries
4. **Pagination**: Paginate trade lists for large datasets
5. **Lazy Loading**: Lazy load charts and heavy components
6. **CDN**: Serve static assets via CDN (future)

## Testing Strategy

### Backend
- Unit tests for services and calculations
- Integration tests for API endpoints
- Database migration tests

### Frontend
- Component unit tests (React Testing Library)
- Integration tests for user flows
- E2E tests for critical paths (Playwright)

## Deployment Checklist

- [ ] Create `env.template` with all required variables
- [ ] Set up PostgreSQL with proper volumes
- [ ] Configure Traefik labels for HTTPS
- [ ] Add Homepage labels
- [ ] Test all API endpoints
- [ ] Verify responsive design on mobile
- [ ] Set up backup strategy for database
- [ ] Document setup process in README

## Requirements Summary

### Trade Types Supported
- **STOCK**: Traditional stock trades
- **OPTION**: Options trades (single-leg only for MVP)
- **CRYPTO_SPOT**: Cryptocurrency spot trades
- **CRYPTO_PERP**: Cryptocurrency perpetual futures
- **PREDICTION_MARKET**: Prediction market trades

### Options Chain Fields (All Fields)
- Strike price, expiration date, call/put
- **All Greeks**: Delta, Gamma, Theta, Vega, Rho
- Implied Volatility (IV)
- Volume and Open Interest
- Bid/Ask prices and spread

### Chart Timeframes
- Support for all: 1m, 5m, 15m, 1h, 1d
- **Primary/Default**: 1h timeframe
- Configurable date range (default: 1 year, configurable)

### Performance Metrics
- **Basics**: Net P&L, Gross P&L, Win Rate, Profit Factor
- **Advanced**: Max Drawdown, Average Win/Loss, Day Win Rate
- **Composite**: Zella Score

### Multi-leg Strategies
- **MVP**: Single-leg only (no spreads, iron condors, etc.)
- **Future**: Multi-leg support planned

### Data Export
- **MVP**: Not included
- **Future**: CSV/Excel export planned

### Authentication
- **MVP**: Single user with API key authentication
- All endpoints accessible via API for AI agent interaction

## Next Steps

1. Review and approve this implementation plan
2. Answer clarification questions
3. Set up initial project structure
4. Begin Phase 1 implementation

---

**Estimated Development Time**: 3-4 weeks for MVP
**Complexity**: Medium-High
**Dependencies**: PostgreSQL, Alpha Vantage API (or similar), TradingView Charts library

