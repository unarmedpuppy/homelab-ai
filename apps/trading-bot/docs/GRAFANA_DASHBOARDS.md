# Grafana Dashboards Guide

**Status**: ✅ Complete  
**Last Updated**: December 19, 2024

## Overview

This document describes the Grafana dashboards available for monitoring the Trading Bot. All dashboards are automatically provisioned when Grafana starts and are available in the "Trading Bot" folder.

## Dashboard List

### 1. Main Overview Dashboard
**File**: `grafana/dashboards/main-overview.json`

Comprehensive overview of the entire system including:
- Request rate and response times
- Error rates
- System health (CPU, memory, disk)
- Signals generated
- Portfolio P/L summary
- Broker connection status
- Provider metrics overview

**Best For**: Quick system health check, high-level monitoring

### 2. Trading Dashboard
**File**: `grafana/dashboards/trading.json`

Detailed trading operations metrics:
- Trades executed and rejected
- Trade execution duration
- Order fill times
- Slippage distribution
- Open positions by symbol
- Position P/L tracking
- Portfolio P/L and value
- Trading statistics

**Best For**: Monitoring trading performance, execution quality

### 3. Strategy Performance Dashboard
**File**: `grafana/dashboards/strategy-performance.json`

Strategy evaluation and signal generation metrics:
- Signals generated by strategy
- Signal types distribution
- Strategy evaluation duration
- Signal confidence distribution
- Strategy win rates
- Trades by strategy
- Signals by symbol
- Strategy performance summary

**Best For**: Analyzing strategy effectiveness, optimizing strategies

### 4. System Health Dashboard
**File**: `grafana/dashboards/system-health.json`

Comprehensive system resource and performance monitoring:
- CPU usage
- Memory usage (bytes and percentage)
- Disk usage
- System uptime
- HTTP request/error rates
- Response time distribution
- Provider metrics
- Cache hit rates
- Rate limit hits

**Best For**: System monitoring, capacity planning, troubleshooting

### 5. Sentiment Analysis Dashboard
**File**: `grafana/dashboards/sentiment.json`

Sentiment provider performance and usage:
- Provider request rates
- Cache hit rates by provider
- Provider response times
- Provider errors
- Rate limit hits
- Provider usage distribution
- Success rates
- Provider metrics summary

**Best For**: Monitoring sentiment data sources, optimizing provider usage

### 6. Risk Management Dashboard
**File**: `grafana/dashboards/risk-management.json`

Risk metrics and portfolio risk monitoring:
- Maximum drawdown
- Daily loss limits
- Position size limits
- Risk per trade
- Daily P/L vs loss limits
- Portfolio P/L history
- Position sizes vs limits
- Trade rejection rates
- Risk metrics summary

**Best For**: Risk monitoring, compliance, risk management

### 7. Error Tracking Dashboard
**File**: `grafana/dashboards/error-tracking.json`

Error monitoring and analysis:
- HTTP error rates by type
- HTTP status code distribution
- Provider errors by type
- Provider error rates
- Error vs request rates
- Rate limit hits
- Trades rejected by reason
- Error summary tables
- Error statistics

**Best For**: Troubleshooting, error analysis, reliability monitoring

## Dashboard Access

1. **Grafana URL**: `http://localhost:3000` (default)
2. **Default Credentials**: 
   - Username: `admin` (or `GRAFANA_ADMIN_USER`)
   - Password: `admin` (or `GRAFANA_ADMIN_PASSWORD`)
3. **Dashboard Location**: Navigate to "Dashboards" → "Trading Bot" folder

## Dashboard Features

All dashboards include:
- **Auto-refresh**: Configurable refresh intervals (10s, 30s, 1m, 5m, etc.)
- **Time range selector**: 6 hours default, adjustable
- **Interactive panels**: Click to drill down, zoom, inspect
- **Responsive layout**: Panels adjust to screen size
- **Color-coded metrics**: Green/yellow/red thresholds for quick status identification

## Customization

Dashboards can be customized in Grafana UI:
1. Open a dashboard
2. Click "Settings" (gear icon)
3. Click "Save" → "Save As" to create a copy
4. Make modifications
5. Save your custom version

**Note**: Auto-provisioned dashboards are read-only. Create copies to customize.

## Prometheus Data Source

All dashboards require the Prometheus data source to be configured:
- **URL**: `http://prometheus:9090` (container name)
- **Access**: Proxy
- **Pre-configured**: Yes (via `grafana/provisioning/datasources/prometheus.yml`)

## Troubleshooting

### Dashboards Not Appearing

1. Check Grafana logs: `docker logs trading-bot-grafana`
2. Verify dashboard files exist in `grafana/dashboards/`
3. Check provisioning config in `grafana/provisioning/dashboards/default.yml`
4. Restart Grafana: `docker restart trading-bot-grafana`

### No Data in Panels

1. Verify Prometheus is scraping: `http://localhost:9090/targets`
2. Check metrics endpoint: `http://localhost:8000/metrics`
3. Verify Prometheus data source is connected in Grafana
4. Check time range (try "Last 6 hours" or longer)
5. Verify metrics are being collected (check Prometheus queries)

### Missing Metrics

1. Verify metrics are enabled: `METRICS_ENABLED=true`
2. Check application logs for metrics errors
3. Verify metric names match dashboard queries
4. Check Prometheus for metric availability: `http://localhost:9090/graph`

## Dashboard Maintenance

Dashboards are version-controlled in the repository. To update:
1. Modify JSON files in `grafana/dashboards/`
2. Commit changes
3. Restart Grafana to reload (or wait for auto-reload every 10 seconds)

## Performance Considerations

- **Refresh Rate**: Lower refresh rates (30s-1m) reduce load
- **Time Range**: Shorter time ranges load faster
- **Panel Count**: More panels = more queries = slower loading
- **Queries**: Complex queries with many labels can be slow

## Best Practices

1. **Start with Main Overview**: Use for daily monitoring
2. **Drill Down**: Click panels to inspect specific metrics
3. **Set Alerts**: Configure alerts based on dashboard thresholds
4. **Customize**: Create copies for team-specific views
5. **Document**: Add descriptions to panels for team understanding

## Related Documentation

- `METRICS_OBSERVABILITY_IMPLEMENTATION_PLAN.md` - Full metrics implementation plan
- `METRICS_PHASE_1_2_SUMMARY.md` - Implementation summary
- Prometheus Alert Rules: `prometheus/alerts.yml`

---

**Last Updated**: December 19, 2024

